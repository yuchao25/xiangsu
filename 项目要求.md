# 项目要求文档

> **📖 每次对话前必读：在开始任何开发工作之前，必须完整阅读并理解本文档的所有内容。本文档与《文件管理规范.md》共同构成项目开发的强制性规范。**

> **⚠️ 重要声明：本文档为本项目的强制性开发规范，所有开发工作必须严格遵守本文档中的各项要求。任何代码编写、功能实现、技术选型均需符合本文档规定。如有特殊需求需修改规范，需先更新本文档并经确认后方可执行。**

> 本文档为项目开发的纲领性文件，所有开发工作均需遵循以下规范和要求。

---

## 一、项目概述

### 1.1 项目类型
- **项目类型**: Web应用
- **技术栈**: React + Node.js
- **开发语言**: JavaScript/TypeScript

### 1.2 项目目标
构建一个功能完善、性能优良、用户体验良好的Web应用程序。

---

## 二、功能需求

### 2.1 核心功能模块
- [ ] 用户认证与授权（登录、注册、权限管理）
- [ ] 数据展示与管理
- [ ] 用户交互功能
- [ ] 数据持久化与同步
- [ ] 响应式设计支持多终端

### 2.2 功能开发原则
1. **用户优先**: 所有功能设计以用户体验为核心
2. **渐进增强**: 基础功能优先，高级功能逐步迭代
3. **可维护性**: 功能模块化，便于后续扩展和维护
4. **性能优化**: 关注加载速度和响应时间

---

## 三、技术规范

### 3.1 前端技术规范（React）

#### 3.1.1 框架与库
- **核心框架**: React 18+
- **状态管理**: Redux Toolkit / Zustand / Context API
- **路由**: React Router v6+
- **UI组件库**: Ant Design / Material-UI / Tailwind CSS
- **HTTP客户端**: Axios / Fetch API
- **表单处理**: React Hook Form

#### 3.1.2 代码结构
```
src/
├── components/      # 可复用组件
│   ├── common/     # 通用组件
│   └── features/   # 特定功能组件
├── pages/          # 页面组件
├── hooks/          # 自定义Hooks
├── services/       # API服务
├── store/          # 状态管理
├── utils/          # 工具函数
├── types/          # TypeScript类型定义
├── styles/         # 样式文件
└── App.tsx         # 应用入口
```

#### 3.1.3 组件开发规范
- 使用函数式组件 + Hooks
- 组件名使用PascalCase命名
- Props使用TypeScript定义类型
- 组件保持单一职责原则
- 使用React.memo优化性能（必要时）

#### 3.1.4 样式规范
- 优先使用CSS Modules或Styled Components
- 避免内联样式（特殊情况除外）
- 使用语义化的CSS类名
- 响应式设计优先（Mobile First）

### 3.2 后端技术规范（Node.js）

#### 3.2.1 框架与库
- **核心框架**: Express.js / NestJS / Koa
- **数据库**: MongoDB / PostgreSQL / MySQL
- **ORM/ODM**: Mongoose / Prisma / TypeORM
- **认证**: JWT / Passport.js
- **验证**: Joi / Zod / class-validator
- **日志**: Winston / Morgan

#### 3.2.2 代码结构
```
src/
├── controllers/    # 控制器
├── services/       # 业务逻辑
├── models/         # 数据模型
├── routes/         # 路由定义
├── middlewares/    # 中间件
├── utils/          # 工具函数
├── config/         # 配置文件
├── types/          # TypeScript类型定义
└── app.ts          # 应用入口
```

#### 3.2.3 API设计规范
- 遵循RESTful API设计原则
- 使用语义化的HTTP方法（GET、POST、PUT、DELETE）
- 统一的响应格式：
  ```json
  {
    "success": true,
    "data": {},
    "message": "操作成功",
    "code": 200
  }
  ```
- 适当的HTTP状态码使用
- API版本控制（如：/api/v1/）

#### 3.2.4 安全规范
- 所有API端点进行身份验证（除公开端点）
- 输入数据验证与过滤
- SQL注入防护
- XSS攻击防护
- CORS配置
- 敏感信息加密存储

### 3.3 数据库规范
- 使用索引优化查询性能
- 合理设计数据表结构
- 数据迁移脚本管理
- 定期备份策略

---

## 四、代码风格要求

### 4.1 通用规范
- **代码格式化**: 使用Prettier
- **代码检查**: 使用ESLint
- **代码提交**: 遵循Conventional Commits规范
  - `feat`: 新功能
  - `fix`: 修复bug
  - `docs`: 文档更新
  - `style`: 代码格式调整
  - `refactor`: 代码重构
  - `test`: 测试相关
  - `chore`: 构建/工具链相关

### 4.2 命名规范
| 类型 | 命名规则 | 示例 |
|------|----------|------|
| 变量/函数 | camelCase | `getUserData()` |
| 类/组件 | PascalCase | `UserProfile` |
| 常量 | UPPER_SNAKE_CASE | `API_BASE_URL` |
| 文件 | kebab-case | `user-service.ts` |

### 4.3 注释规范
- 复杂逻辑必须添加注释说明
- 函数/组件添加JSDoc注释
- TODO/FIXME标记待办事项
- 保持注释与代码同步更新

### 4.4 TypeScript规范
- 优先使用TypeScript编写代码
- 避免使用`any`类型
- 使用接口定义数据结构
- 合理使用泛型

---

## 五、开发流程规范

### 5.1 版本控制
- **Git工作流**: Git Flow / Feature Branch
- **分支命名**: `feature/功能名`、`fix/问题描述`、`hotfix/紧急修复`
- **代码审查**: 所有代码合并前必须经过Code Review

### 5.2 测试要求
- **单元测试**: 核心业务逻辑覆盖率 ≥ 80%
- **集成测试**: API接口测试
- **E2E测试**: 关键用户流程测试
- **测试框架**: Jest + React Testing Library / Cypress

### 5.3 部署规范
- **环境区分**: development、staging、production
- **CI/CD**: 自动化构建、测试、部署
- **环境变量**: 使用`.env`文件管理，敏感信息不提交

---

## 六、性能要求

### 6.1 前端性能
- 首屏加载时间 < 2秒
- 路由切换流畅（< 300ms）
- 图片懒加载
- 代码分割与按需加载
- 浏览器缓存策略

### 6.2 后端性能
- API响应时间 < 500ms（P95）
- 数据库查询优化
- 使用缓存机制（Redis）
- 并发处理能力

---

## 七、文档要求

### 7.1 代码文档
- README.md：项目说明、安装步骤、使用方法
- API文档：使用Swagger/OpenAPI
- 组件文档：Storybook（可选）

### 7.2 更新维护
- 重大变更及时更新文档
- 保持文档与代码同步

---

## 八、文件管理规范

> **⚠️ 重要：为避免文件混乱，所有文件创建和管理必须严格遵守本章节规范。**

### 8.1 项目目录结构
```
d:/xiangsu/
├── docs/                # 项目文档
│   ├── api/            # API文档
│   ├── design/         # 设计文档
│   └── guides/         # 指南文档
├── plans/              # 计划和方案文档
├── src/                # 源代码目录
│   ├── frontend/       # 前端代码
│   ├── backend/        # 后端代码
│   └── shared/         # 共享代码
├── tests/              # 测试文件
├── scripts/            # 脚本文件
├── config/             # 配置文件
├── .temp/              # 临时文件（自动清理）
├── .archive/           # 归档文件
├── 项目要求.md         # 项目要求文档
├── 文件管理规范.md     # 文件管理详细规范
└── README.md           # 项目说明
```

### 8.2 文件命名规范
| 文件类型 | 命名规则 | 示例 |
|----------|----------|------|
| React组件 | PascalCase | `UserProfile.tsx` |
| 普通模块 | camelCase | `userService.ts` |
| 样式文件 | kebab-case | `user-profile.module.css` |
| 配置文件 | kebab-case | `vite.config.js` |
| 文档文件 | 中文或kebab-case | `项目要求.md`、`api-guide.md` |
| 测试文件 | `.test.ts` 或 `.spec.ts` | `userService.test.ts` |

### 8.3 临时文件管理
- **临时文件目录**: `.temp/`
- **命名格式**: `[功能]-[日期]-[序号].扩展名`
- **示例**: `login-page-20260212-01.md`
- **清理策略**: 每周自动清理超过7天的文件

### 8.4 AI Coding 文件管理规则
1. **开发前准备**
   - 明确任务范围和需要创建的文件
   - 制定文件清单
   - 确认目录结构

2. **开发过程中**
   - 批量创建文件，避免零散创建
   - 立即使用规范命名
   - 严格按照目录结构放置
   - 及时删除不再需要的临时文件

3. **开发后清理**
   - 检查并清理 `.temp/` 目录
   - 整理目录结构
   - 同步更新相关文档

4. **文件数量控制**
   - 单次开发任务建议创建文件不超过 20 个
   - 如需更多文件，分阶段完成
   - 使用模块化设计减少文件数量

### 8.5 文件创建检查清单
创建新文件前必须确认：
- [ ] 文件是否已存在（避免重复）
- [ ] 文件应放在哪个目录
- [ ] 文件命名符合规范
- [ ] 文件用途是否明确

### 8.6 禁止的命名
- ❌ 使用中文拼音（如：`yonghu.ts`）
- ❌ 使用空格（如：`user service.ts`）
- ❌ 使用特殊字符（如：`user@service.ts`）
- ❌ 使用无意义的名称（如：`temp1.ts`、`test.js`）

### 8.7 归档策略
以下情况应将文件归档到 `.archive/` 目录：
- 功能已废弃但需保留历史记录
- 旧版本的代码文件
- 不再使用的配置文件

---

## 九、其他要求

### 9.1 兼容性
- **浏览器**: Chrome、Firefox、Safari、Edge最新两个版本
- **移动端**: iOS 12+、Android 8+

### 9.2 可访问性
- 遵循WCAG 2.1 AA标准
- 支持键盘导航
- 适当的ARIA标签

### 9.3 国际化
- 支持多语言（如需要）
- 使用i18n库管理翻译

---

## 十、附录

### 10.1 推荐工具
- **IDE**: VS Code
- **API测试**: Postman / Insomnia
- **版本控制**: Git + GitHub/GitLab

### 10.2 参考资源
- [React官方文档](https://react.dev)
- [Node.js官方文档](https://nodejs.org/docs)
- [MDN Web文档](https://developer.mozilla.org)
- [详细文件管理规范](./文件管理规范.md)

---

> **最后更新**: 2026-02-12
> **维护者**: 开发团队
