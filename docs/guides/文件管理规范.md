# 文件管理规范

> **📖 每次对话前必读：在开始任何开发工作之前，必须完整阅读并理解本文档的所有内容。本文档与《项目要求.md》共同构成项目开发的强制性规范。**

> 本文档规范项目文件的创建、命名、组织和清理策略，确保项目目录始终保持整洁有序。

---

## 一、项目目录结构规范

### 1.1 根目录结构
```
d:/xiangsu/
├── docs/                # 项目文档
│   ├── api/            # API文档
│   ├── design/         # 设计文档
│   └── guides/         # 指南文档
│       ├── 项目要求.md # 项目要求文档
│       └── 文件管理规范.md # 本文档
├── plans/              # 计划和方案文档
├── src/                # 源代码目录
│   ├── frontend/       # 前端代码
│   ├── backend/        # 后端代码
│   └── shared/         # 共享代码
├── tests/              # 测试文件
├── scripts/            # 脚本文件
├── config/             # 配置文件
├── .temp/              # 临时文件（自动清理）
├── .archive/           # 归档文件
└── README.md           # 项目说明
```

### 1.2 前端代码结构（React）
```
src/frontend/
├── public/             # 静态资源
├── src/
│   ├── assets/         # 图片、字体等资源
│   ├── components/     # 组件
│   │   ├── common/    # 通用组件
│   │   └── features/  # 功能组件
│   ├── pages/         # 页面组件
│   ├── hooks/         # 自定义Hooks
│   ├── services/      # API服务
│   ├── store/         # 状态管理
│   ├── utils/         # 工具函数
│   ├── types/         # TypeScript类型
│   └── styles/        # 样式文件
├── package.json
└── vite.config.js     # 或 webpack.config.js
```

### 1.3 后端代码结构（Node.js）
```
src/backend/
├── src/
│   ├── controllers/   # 控制器
│   ├── services/      # 业务逻辑
│   ├── models/        # 数据模型
│   ├── routes/        # 路由
│   ├── middlewares/   # 中间件
│   ├── utils/         # 工具函数
│   ├── config/        # 配置
│   └── types/         # TypeScript类型
├── tests/             # 测试
├── package.json
└── tsconfig.json
```

---

## 二、文件命名规范

### 2.1 通用规则
| 文件类型 | 命名规则 | 示例 |
|----------|----------|------|
| React组件 | PascalCase | `UserProfile.tsx` |
| 普通模块 | camelCase | `userService.ts` |
| 样式文件 | kebab-case | `user-profile.module.css` |
| 配置文件 | kebab-case | `vite.config.js` |
| 文档文件 | 中文或kebab-case | `项目要求.md`、`api-guide.md` |
| 测试文件 | `.test.ts` 或 `.spec.ts` | `userService.test.ts` |

### 2.2 禁止的命名
- ❌ 使用中文拼音（如：`yonghu.ts`）
- ❌ 使用空格（如：`user service.ts`）
- ❌ 使用特殊字符（如：`user@service.ts`）
- ❌ 使用无意义的名称（如：`temp1.ts`、`test.js`）

### 2.3 AI生成的临时文件命名
- AI生成的草稿/临时文件统一放入 `.temp/` 目录
- 命名格式：`[功能]-[日期]-[序号].md` 或 `[功能]-[日期]-[序号].ts`
- 示例：`login-page-20260212-01.md`、`auth-service-20260212-01.ts`

---

## 三、文件创建规范

> **⚠️ 强制规则：所有新建文档必须自动放入相应的文件夹中，不得直接放在根目录。**

### 3.1 文件分类放置规则
| 文件类型 | 放置目录 | 说明 |
|----------|----------|------|
| API文档 | `docs/api/` | API接口文档、Swagger导出 |
| 设计文档 | `docs/design/` | 架构设计、UI设计、数据库设计 |
| 指南文档 | `docs/guides/` | 项目要求、开发规范、使用指南 |
| 计划方案 | `plans/` | 项目计划、技术方案、需求文档 |
| 前端代码 | `src/frontend/` | React组件、页面、hooks等 |
| 后端代码 | `src/backend/` | Node.js控制器、服务、模型等 |
| 共享代码 | `src/shared/` | 前后端共享的类型、工具函数等 |
| 测试文件 | `tests/` | 测试用例、测试数据 |
| 脚本文件 | `scripts/` | 构建脚本、部署脚本、工具脚本 |
| 配置文件 | `config/` | 环境配置、应用配置 |
| 临时文件 | `.temp/` | AI生成的草稿、测试代码 |
| 归档文件 | `.archive/` | 已废弃或旧版本文件 |

### 3.2 创建前检查
在创建新文件前，必须确认：
1. [ ] 确认文件是否已存在（避免重复）
2. [ ] 确认文件应放在哪个目录（参考3.1文件分类放置规则）
3. [ ] 确认文件命名符合规范
4. [ ] 确认文件用途是否明确

### 3.2 文件职责单一原则
- 每个文件只负责一个功能或模块
- 避免在一个文件中混合多种职责
- 文件大小建议控制在 500 行以内

### 3.3 代码文件必须包含
- 文件头部注释说明文件用途
- 必要的导入语句
- 清晰的导出

```typescript
/**
 * 用户服务模块
 * 负责用户相关的业务逻辑处理
 */

import { User } from '../types';

export class UserService {
  // ...
}
```

---

## 四、临时文件管理

### 4.1 临时文件目录
- **目录**: `.temp/`
- **用途**: 存放AI生成的临时文件、草稿、测试代码
- **清理策略**: 每周自动清理超过7天的文件

### 4.2 临时文件类型
| 类型 | 位置 | 说明 |
|------|------|------|
| AI草稿 | `.temp/drafts/` | AI生成的未确认代码 |
| 测试代码 | `.temp/tests/` | 临时测试代码 |
| 备份文件 | `.temp/backups/` | 修改前的备份 |
| 调试文件 | `.temp/debug/` | 调试相关文件 |

### 4.3 临时文件清理脚本
```bash
# 清理7天前的临时文件
find .temp -type f -mtime +7 -delete
```

---

## 五、文件归档策略

### 5.1 归档条件
以下情况应将文件归档到 `.archive/` 目录：
- 功能已废弃但需保留历史记录
- 旧版本的代码文件
- 不再使用的配置文件

### 5.2 归档目录结构
```
.archive/
├── deprecated/        # 已废弃的文件
├── old-versions/      # 旧版本文件
└── unused/           # 未使用的文件
```

### 5.3 归档文件命名
- 保留原文件名
- 添加归档日期后缀
- 示例：`old-login.ts.20260212`

---

## 六、AI Coding 文件管理建议

### 6.1 开发前准备
1. **明确任务范围**: 每次开发前明确需要创建/修改哪些文件
2. **制定文件清单**: 创建一个待办文件列表
3. **确认目录结构**: 确保目标目录已存在

### 6.2 开发过程中
1. **批量创建**: 一次性创建所有需要的文件，避免零散创建
2. **即时命名**: 创建文件时立即使用规范命名
3. **分类放置**: 严格按照目录结构放置文件
4. **及时删除**: 删除不再需要的临时文件

### 6.3 开发后清理
1. **检查临时文件**: 清理 `.temp/` 目录
2. **整理目录**: 确保所有文件在正确位置
3. **更新文档**: 同步更新相关文档

### 6.4 文件数量控制
- 单次开发任务建议创建文件不超过 20 个
- 如需更多文件，分阶段完成
- 使用模块化设计减少文件数量

---

## 七、Git忽略配置

### 7.1 .gitignore 推荐配置
```gitignore
# 临时文件
.temp/
*.tmp
*.bak
*.swp

# 依赖
node_modules/
.pnp/

# 构建产物
dist/
build/
*.log

# 环境变量
.env
.env.local

# IDE
.vscode/
.idea/
*.suo
*.ntvs*

# 系统文件
.DS_Store
Thumbs.db
```

---

## 八、文件维护检查清单

### 8.1 日常检查（每日）
- [ ] 检查 `.temp/` 目录，清理无用文件
- [ ] 确认新创建的文件命名规范
- [ ] 检查是否有重复文件

### 8.2 周期检查（每周）
- [ ] 清理 `.temp/` 目录中超过7天的文件
- [ ] 检查 `.archive/` 目录，确认归档文件
- [ ] 整理项目目录结构

### 8.3 月度检查（每月）
- [ ] 全面审查项目文件结构
- [ ] 删除长期未使用的文件
- [ ] 更新文档以反映当前结构

---

## 九、最佳实践

### 9.1 文件组织原则
1. **按功能组织**: 相关文件放在同一目录
2. **按层次组织**: 公共文件在上层，具体文件在下层
3. **按生命周期组织**: 临时文件与正式文件分离

### 9.2 减少文件数量技巧
1. **合并相似文件**: 功能相似的文件可以合并
2. **使用索引文件**: `index.ts` 导出多个模块
3. **合理使用子目录**: 避免扁平化结构

### 9.3 文件查找效率
1. **保持目录层级不超过 4 层**
2. **使用语义化的目录名称**
3. **定期整理，避免文件堆积**

---

## 十、常见问题与解决方案

### 10.1 问题：文件太多，难以管理
**解决方案**:
- 定期清理临时文件
- 将不常用文件归档
- 优化目录结构

### 10.2 问题：不知道文件应该放在哪里
**解决方案**:
- 参考本文档的目录结构规范
- 查看类似功能文件的放置位置
- 咨询团队成员

### 10.3 问题：AI生成的文件命名不规范
**解决方案**:
- 在生成前明确命名规范
- 生成后立即重命名
- 将此要求加入项目要求文档

---

> **最后更新**: 2026-02-12
> **维护者**: 开发团队
